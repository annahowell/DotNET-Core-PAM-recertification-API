/* ================================================================================================ */
/* ======================= AFTER RUNNING THIS SCRIPT YOU STILL NEED TO EDIT ======================= */
/* ===================== appsettings.json IN THE "DotNET Core API/PAMrecert" ====================== */
/* ================ FOLDER AND EDIT LINE 8 TO REFLECT THE IP OF YOUR MS SQL SERVER ================ */
/* ================================================================================================ */



/* ---------------- Role User ---------------- */
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('securityManager','Security Manager','Developes and implements security policies, protocols and procedures. Controls budgets for security operations and monitors expenses. Recruits, trains and supervises seurity technicians','complianceManager');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('securityTechnician','Security Technician','Responsible for ensuring digital assets are protected from unauthorised access. Secures both online and on-premise infrastructures, weeding through metrics and data to filter out suspicious activity, and finding and mitigating risks before breaches occur','complianceManager');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('securityPlacement','Security Placement','Supports the security technician to ensure digital assets are protected, helps to secure infrastructure, weeds through metrics and data to filter out suspicious activity and finds and mitigates risks before breaches occur','complianceManager');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('networkManager','Network Manager','Responsible for ensuring network infrastructure and managing deployments','itDirector');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('networkTechnician','Network Technician','Supports the network manager in configuring and implementing network deployments','networkManager');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('linuxManager','Linux Manager','Responsible for the design and implementation of Linux based operating system deployments','itDirector');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('linuxSpecialist','Linux Specialist','Supports the Linux manager in the implementation and design of Linux systems','linuxManager');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('linuxTechnician','Linux Technician','Supports the Linux manager and Linux specialist in the configuration of Linux systems.','linuxManager');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('itDirector','IT Director','Oversees all technology operations and evaluates them according to established goals. Devises and establishing IT policies and systems to support the implementation of strategies','ceo');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('complianceManager','Compliance Manager','Keep the legal and ethical integrity of a company intact through policy enforcement and program planning','ceo');
INSERT INTO RoleTable([RoleId],[RoleName],[RoleDescription],[RoleOwner_RoleId]) VALUES('ceo','Chief Executive Office','REDACTED CEO','');

INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('tomgold1','Gold, Tom','itDirector');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('kimjacobs1','Jacobs, Kim','complianceManager');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('paulrunner1','Runner, Paul','securityManager');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('marksmith1','Smith, Mark','securityTechnician');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('emmahurn1','Hurn, Emma','securityPlacement');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('sharonheart1','Heart, Sharon','networkManager');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('stuartkitson1','Kitson, Stuart','networkTechnician');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('fredsandle1','Sandle, Fred','networkTechnician');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('stevegreen1','Green, Steve','networkTechnician');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('mikelong1','Long, Mike','linuxManager');
INSERT INTO UserTable([UserId],[UserFullName],[RoleId]) VALUES('darrenjones1','Jones, Darren','linuxSpecialist');



/* ---------------- Service Priv ---------------- */
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('zendesk','Zendesk','Platform-as-a-service issue tracking and ticketing system','itDirector');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('nessus','Nessus','Provides web application scanning, vulnerability management and a various other security scanning tools','complianceManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('forcepoint','Forcepoint','Cloud delivered security service providing logging and filtering of web traffic','complianceManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('hashiCorp','HashiCorp','Privileged access security solution used to secure privileged credentials and secrets either on-prem or in the cloud','itDirector');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('sonicWall','SonicWall Alto','Physical firewall appliances supporting automation and integration.','networkManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('fortiGate','FortiGate','FortiGate firewall and networking platorm','networkManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('bitbucket','Bitbucket','Web-based DevOps lifecycle tool that provides a Git-repository manager providing wiki, issue-tracking and continuous integration/continuous deployment pipeline features, using an open-source license','linuxManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('sublime','Sublime','Text editor for code, markup and prose','linuxManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('rapid7','Rapid7','SIEM Platform helps align people, processes, and technology to detect and stop cyberthreats','complianceManager');
INSERT INTO ServiceTable([ServiceId],[ServiceName],[ServiceDescription],[ServiceOwner_RoleId]) VALUES('puTTY','PuTTY','Free implementation of SSH and Telnet for Windows and Unix platforms, along with an xterm terminal emulator','itDirector');

INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('nessusGuest','nessus','Nessus guest','May view the result of security scans and export results','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('hashiCorpGuest','hashiCorp','HashiCorp guest','Allows users to retreive credentials available to guest users','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('sonicWallSuperUser','sonicWall','SonicWall superUser','Gives full access to SonicWall Alto software, including the configuration of all settings and the provisioning of new accounts','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('sonicWallLogViewer','sonicWall','SonicWall logViewer','Allows viewing of firewall access logs and exporting the logs in the csv format','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('forcepointAdmin','forcepoint','Forcepoint admin','Provides full access to Forcepoint, including the configuration of all software settings and the provisioning of new administrative accounts','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('bitbucketSuperUser','bitbucket','Bitbucket superUser','Full access to the on-prem bitbucket SaaS platform','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('forcepointReader','forcepoint','Forcepoint reader','Allows viewing access logs and exporting logs to csv and pdf files','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('fortiGateRoot','fortiGate','FortiGate root','Super user access on all FortiGate firewall devices. NOTE: May allow installation of additional SSH keys','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('zendeskSuperUser','zendesk','Service Now superUser','Super users may amend all tickets, forms and backend workflows associated with the Zendesk forms','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('nessusAdmin','nessus','Nessus admin','Provides total access to Nessus admin panel, including the creation of new users and amending all scan types and schedules ','Attached to admin Account');
INSERT INTO PrivTable([PrivId],[ServiceId],[PermissionGroup],[ServicePrivSummary],[CredentialStorageMethod]) VALUES('rapid7Admin','rapid7','Log Rhythm Admin','Gives full access to the SIEM system, including logging configuration, log viewing and exporting and creating additional admin user accountss','Attached to admin Account');



/* ---------------- Role Service Priv ---------------- */
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('securityManager','nessusAdmin','Needed due to owning the service','It will no longer be possible to administer the service','0','0','2020-03-28','nessusAdmin','Self-certified admin as service owner','It will not longer be possible to administer the service','0','0','2020-06-27',3,3,'Service owner and manager are the same role','2020-04-24');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('securityManager','rapid7Admin','Required to administer the SIEM system','I will no longer be able to admin the server and fully perform my job function','0','0','2020-03-28','rapid7Admin','Talked to manager who assures me they still need this','Manager will not be able to do their job properly','0','0','2020-06-27',3,3,'','2020-04-24');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('securityTechnician','forcepointReader','Required to view and export logs as part of routine security investigations','Inability to conduct security investigations','0','0','2019-05-19','forcepointAdmin','They do not need admin!','None','1','1','2019-01-23',2,2,'Manager has certified reader and service owner has revoked entirely, need to liaise with both to properly ascertain risk','2019-03-20');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('securityTechnician','nessusGuest','Required by role in order to view results of security scans','Security scan results will be inaccessible to role, preventing their evaluation','0','1','2020-04-07','nessusGuest','The role no longer requires access to this service and should only be used by managers','None - Technicians should no longer need this','0','1','2018-09-09',5,2,'None','2019-07-26');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('securityPlacement','forcepointReader','Role requires access to logs in order to conduct investigations.','Investigations in to employee website visits will no longer be possible','0','0','2019-05-19','forcepointReader','Conduct their investigations','They will no longer be able to carry out investigations properly','0','1','2019-01-23',2,2,'','2019-03-20');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('securityPlacement','hashiCorpGuest','Needed to retreive basic credentials in order to login to systems','Removing this by proxy removes all of their access to low security systems','0','1','2018-12-21','hashiCorpGuest','Needed to get login/pass details','They will no longer be able to login to simple systems','0','1','2020-04-07',1,3,'None','2020-05-18');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('linuxTechnician','bitbucketSuperUser','odio. Aliquam vulputate ullamcorper magna.','molestie sodales. Mauris','0','1','2018-09-09','bitbucketSuperUser','nisi. Mauris nulla.','Mauris ut','0','0','2020-06-27',2,4,'inceptos hymenaeos. Mauris ut quam vel sapien imperdiet ornare. In','2018-09-18');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('networkTechnician','sonicWallSuperUser','nisi. Mauris nulla.','Mauris ut','0','0','2020-06-27','sonicWallSuperUser','nisi. Mauris nulla.','Mauris ut','0','0','2020-06-27',3,2,'senectus et netus et malesuada fames ac turpis egestas. Aliquam','2018-11-25');
INSERT INTO RolePrivLink([RoleId],[RoleOwner_PrivId],[RoleOwner_RoleAccessJustification],[RoleOwner_RemovalImpact],[RoleOwner_IsRevoked],[RoleOwner_IsCertified],[RoleOwner_DateCertified],[ServiceOwner_PrivId],[ServiceOwner_RoleAccessJustification],[ServiceOwner_RemovalImpact],[ServiceOwner_IsRevoked],[ServiceOwner_IsCertified],[ServiceOwner_DateCertified],[RiskImpact],[RiskLikelihood],[RiskNotes],[RiskAssessmentDate]) VALUES('networkTechnician','fortiGateRoot','scelerisque sed, sapien. Nunc','luctus aliquet odio. Etiam','0','0','2019-06-20','fortiGateRoot','sit amet nulla. Donec non justo.','Etiam imperdiet dictum magna. Ut tincidunt','0','0','2020-03-28',2,5,'ac mi eleifend egestas. Sed pharetra,','2019-05-03');
